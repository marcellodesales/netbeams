% main.tex, to be used with thesis.tex
% This contains the main work of your thesis.

%\bibliography{thesis}  % uses the references stored in Chapter1Radar.bib

\chapter{State of the Art}

Different aspects related to two major fields of Computer Science have
motivated to the inception of this work. In the perspective of Database
Systems and Distributed Systems, this work seeks a different approach for a
persisting collected data from sensor networks into a storage system that can
be seen as a cluster of distributed databases. Likewise, in the perspective of
Software Engineering, this work adds a major capability to an existing sensor 
network framework, meeting the requirements and interfaces. In general, this 
chapter gives the foundation based on the motivations for the inception of a 
different approach to persisting data using a different data model, covering 
topics that will be referred throughout the following other chapters.

This chapter will first give an overview on different related problems
described  in the literature that solved problems related to data modeling and 
representation in sensor networks. Then, it presents the design, architecture 
and implementation details of the DSP Platform, which is the bases for this 
dissertation. Finally, this chapter will briefly give a tutorial on advanced 
topics such as the differences between the KVP data model and the relational 
data model, as well as discussing about the approaches used on Database
Sharding.

\section{Sensor Networks Survey}

Sensor Networks are specialized types of network systems comprised of network 
nodes with specific goals to observe and collect data. The following
subsections describe classes of characteristis of these types of sensor
networks, with applications on research, industrial or militery.

\subsection{Deployment and Mobility}

Each of the nodes can be deployed in a random way such as being dropped
from an airplane, or in a manual fashion at deliberately chosen geographical 
points \cite{sn-intro01}. Moreover, the deployment can be done as a one-time
event or an iterative way. 

However, nodes can be able to move around the deployed area or be static in
this place. In the case of the degree of the former behaviour, a sensor node
can move occasionally or continuously, being a result of an incidental 
side-effect or a desired property of the device, where they are an automotive
device or attached to another moving object. For this reason, \cite{sn-intro01} 
describes those types of mobility as active or passive.

\subsection{Device Size, Resources, Cost, Energy, Heterogeneity}

Such sensor nodes can be of different sizes, ranging from microscopically small
particles, small devices to bigger ones with a few feet cubic. In addition to
being limited in size, they are also limited in resources and computational
power, forcing their conception limited to have its energy stored in either
batteries or scavenged from solar cells \cite{sn-intro01}.

Since sensor devices range on size and capabilities, the cost for each of the
devices very from hundreds to thousands of dollars, depending on its
functionality, energy utilization, etc. For thie reason, \cite{sn-intro01}
explains that a sensor network may potentially contain similar sensor devices,
as they can contain dissimilar ones from each other, which characterizes the heterogeneity 
of a sensor network by the hardware capabilities such as GPS enabled or having
GSM  network connectivity.

\subsection{Communication Modality, Network Infrastructure, Coverage and
Connectivity}
\label{sec:sn-infrastructure}

Sensor nodes can communicate in different modalities such as radio, diffuse
light, inductive or sound, which may influence on the type of protocols used to
communicate among the nodes, where they can be said to be in an organized
infrastructure or as an ad hoc way \cite{sn-intro01}.

When it comes to the sensor network different organizational infrastructure,
they can differ in types of topology: single-hop, star, networked stars, tree
and graph, where each of them may affect the characteristics of the network as it 
may also influence on data gathering and routing mechanisms. While in a
single-hop sensor network there are only two levels of sensor connectivity, the
tree, graph or networked stars networks uses communications among the network
hosts for data communication.

Last, but not least, sensor networks may be influenced its coverage designed in
its purpose, its size in terms of number of nodes and its relating lifetime. As
sensors are deployed in different areas, they can be distributed in a sparse or
dense way, yet providing necessary coverage for the environment. However, 
considering that sensor devices are very likely to constant failures, projects 
have provided redundant nodes \cite{sn-intro01}. This degree of coverage also 
influences on the connectivity of the sensor nodes, where they can be
considered connected when a connection is available at all times. On the other
hand, nodes can communicate with other nodes in an intermittent way or sporadic
way. In the former, the sensor node is partitioned, while in the latter the
nodes are isolated most of the time and communicates at certain moments in
time.

\subsection{Network Size, Lifetime and Quality-Of-Service}

Similar to the degree of coverage of the sensor network is the number of
sensor nodes deployed in the network, where they can be in the order of
dozens, hundreds or even thousand of nodes \cite{sn-intro01}.

The application of the sensor network determines how long the sensor
network may be exist. For example, the lifetime of an environmental sensor
networks \cite{sn-ex01} may be not determined since its service serves in a
regular basis, whereas the lifetime of a sensor network to determine the number
of people in an event is limited to the event. 

Finally, the design of sensor networks can be related to the constraints
related to quality-of-service (QoS) such as real-time delivery within certain
period of time or robustness such as maintaining data alive even though there
a communication link is not available \cite{sn-intro02}.

\section{Persistence Storage for Sensor Networks}

The most important purpose of a sensor network is related to its main product:
the use of the raw data. Data collection in sensor networks is directly
dependent on the specifications of the sensor network, its routing mechanisms
and the final destination of the produced data. In a nutshell,
\cite{sn-storage03} describes data as follows:

\begin{itemize}
  \item \textbf{low-level property} as the raw data collected from the
  sensor device; For example, the sea level as a number;
  \item \textbf{Observation or Event} as the processed data in format of the final
  observation. For instance, if the ocean is in its high tight or low tight.
\end{itemize}

\subsection{The Purpose of the Collected Data}
\label{sec:sn-data-purpose}

At first glance, the raw data serves as the primary product of the sensor
network. However, the first consideration that must take place is regarding the
purpose of the collected data, as \cite{sn-provenance} explains
differentiates between two main use of the sensor data:

\begin{itemize}
  \item \textbf{Real-time Data Stream}, as the generated data from the sensor is
  actually not transmitted, but extracted from the device as it is requested.
  The data is still in its natural format specified by the sensor manufacturer;
  \item \textbf{Archival Data}, as the collected data have historical value or will
  be use by other applications at a future time. 
\end{itemize}

While real-time data stream are used and can potentially be discarded, the
archival data needs to be stored in a secondary memory. Nonetheless, given the
nature of the sensor device specification, the low-level data produced
by a given sensor device might not contain necessary information regarding the
identity of the data itself. The use of Data Provenance techniques is described
by \cite{sn-provenance} as an important step to provide the collected data 
specific metadata regarding its location and lineage.

Under these circumstances, the collected data needs first to face its jorney
starting from its transmission from its producing device to the specified data 
sink as specified by \cite{sn-storage01} \cite{sn-storage02} \cite{sn-storage03}.

\subsection{Storage Location for Collected Data}
\label{sec:sn-storage-locations}

Given that collected data can be used for different purposes as described in
section \ref{sec:sn-data-purpose}, the sensor node that produces the data is
responsible to send the raw data to a specified data storage destination. Upon
producing data, a sensor network node is specified to deal with the produced
data, where in most cases, \cite{sn-storage03} described that depending on the
sensor network infrastructure (see section \ref{sec:sn-infrastructure}),
different storage mechanisms are provided:

\begin{itemize}
  \item \textbf{External Storage}: the sensor device sends the produced data to
  another sensor node that contains an external storage. 
  \item \textbf{Local Storage}: as it is the case of real-time data stream, where data
  is allocated on the sensor device's main read-only memory.
\end{itemize}

It is clear that the data flows from the sensor node to another depending on
the specification of the network. On the whole, the sensor network
infrastructure dictates where the data will flow to, as described in section
\ref{sec:sn-infrastructure}. \cite{sn-storage02} sees a wireless sensor
networks as a many-to-one data gathering pattern, when its organization is
based on single-hop or star. On the other hand, when the data organization is
structured as a graph, tree, etc, the data flows from one intermediate sensor
node to another until it reaches its final storage node as described by
\cite{sn-storage01} \cite{sn-storage03}. 

Last, but not least, yet a different storage strategy can be used: Data-Centric
Storage. This strategy aims at clustering the collected data based on a given nature of the
data such as location. Regardless the data storage mechanism used, the query
processing will depend on the sensor network infrastructure and data location.

\subsection{Query Processing for Storage Locations}
\label{sec:query-process}

Given the different locations where the collected data might be as described in
section \ref{sec:sn-storage-locations}, different query processing for the
collected sensor data can be used as described by \cite{sn-storage03}:

\begin{itemize}
  \item \textbf{In-Network Query Processing}: sensor nodes that provides
  real-time data stream usually replies to requests to properties. Likewise, when the
  data is used for archival purpose, the data can be located at a network node
  specialized in storing the neighbors collected data. In this way, when a
  query is issued to the sensor network, the query processor will
  collectively verify every storage node for the collected data.
  \item \textbf{Centralized Query Processing}: a main network sink receives the
  collected data from the peer nodes. In this case, the query processor queries
  the solo centralized node for the overall values of the participating sensor
  devices.
\end{itemize}

There are pros and cons related to both of the approaches of query processing,
which are also related to the infrastructure, sensor network nature and 
requirements. The main goal of the in-network query processing is to decrease
the amount of data transmitted from the sensor devices to the final data sink, as
sensor devices are usually limited by constraints such as energy utilization 
\cite{sn-storage03}. Along with this strategy, the literature describes
different proposals that aims at upgrading the Structured Query Language (SQL)
adding location-sensitive clauses to the language \cite{sn-db-newop}. However,
this main problem related to this approach is that it may potentially flood
all nodes with query messages \cite{sn-storage04}.

In order to mitigate the problems related flooded nodes in in-network query
processing, the use of a Data-Centric storage strategy has been shown to be a
proven alternative for the sake of energy consumption \cite{sn-storage03}
\cite{sn-storage01}. Its main goal is to classify the collected data based in a
specific property, say location or event, in order to be sent to specific
storage nodes that relates to the observation. As the main outcome of this
strategy is to create network partitioning strategy, the query processor would
hit specific sensor nodes with the needed data, and therefore, would
decrease the load and maximize the capacity on the actual sensor devices.

A centralized network query processing processes data in a network node
specified as the network sink. The network sink usually is a network
node with a database server with the collection of data delivered by
all the sensor devices from the network. As a consequence of this
many-to-one communication strategy \cite{sn-storage02}, the query process does
not affect any of the sensor nodes in the network and, thus, maximizes the
sensor device utilization. Moreover, the use of the data for historical
purposes is easier to manage and give access to the primary end users of the
data, following the process of data processing, compression, aggregation, etc
\cite{sn-db-modeling02}.

Although this approach seems to be convenient to the point of view of the
sensor nodes and used as the tradeoff between achieving capacity and energy
consumption, the centralized data collector suffers from the annavoiable
creation of a point of traffic concentration \cite{sn-storage02}, also referred
to as the phenomenon of congestion, or funneling effect \cite{sn-storage04}.
For this reason, simple distributed system techniques such as the use of
master-slave or data replication can be used to decrease the overhead.

\section{Data Models and Query Engines for Sensor Networks}
\label{sec:data-models}

Different approaches are used to represent the collected data from sensors. The
use of simple data descriptors have been used in research groups which
expertise is not database systems, while others use such technology and the way
to represent data using more robust approaches. \cite{sn-data-model-survey}
have shown different data models and the advantages and desadvantages. The
following is a summary of these approaches used by the sensor network
community.

\begin{itemize}
  \item \textbf{Tabular Data Model}: comma-separeted values are very popular
  due to its simplicity. Although data is not index, it is an easy approach for data
 exchange among researchers.
  \item \textbf{Relational Data Model}: it is used in the majority of the
  projects. Most of them due to the easy access to database systems, with
  refactored versions that support the implementation of sensor networks and
  its requirements \cite{sn-db-tinydb};
  \item \textbf{Structured Data Model}: simiar to the relational model,
  structured data models are becoming popular due to the Internet. The use of
  XML data \cite{xml} is not yet popular, but there are a few projects using it
  \cite{sn-xml-usage01}\cite{sn-xml-usage01}, implementing its query by using a
  middleware \cite{sn-xml-middleware} \cite{sn-xml-query-engines}.
  \item \textbf{Key-Value Pair and Document-Oriented Data Model}: as
  an emerging data model, the Key-Value Pair (KVP) \cite{db-kvp} data model is
  becoming popular with the up-coming trend of cloud computing. Although there are no
  records of the use of this model data model in sensor networks, this work
  will investigate it.
\end{itemize}

Most importantly, the use of Data Provenance approaches to describe the
collected data is shown to be important \cite{sn-provenance}, given the nature
of the collected data. Therefore, this section describes these approaches for
modeling data collected from sensor devices, taking into account the need of
metadata for the data.

\subsection{Tabular Data Model and Query}

Simple use of Comma-Separated Values is an example os sensor network data. Data
is structured by the top header, and the values are in each line of the file.
The implementation of the SF-BEAMS \cite{sfbeams2006} uses this approach. In
summary, in a tabular data model

\begin{itemize}
  \item data is represented by columns in a flat file separated by a character
  that separates the values. One example of such data in sensor networks is the
  OPenDAP \cite{opendap} format, used by the SF-BEAMS project
  \cite{sfbeams2006}.
  \item data is queried using a text editor file, without any indexing
  associated with it. 
\end{itemize}

\subsection{Relational Data Model and Query}

Many different projects have used the relational model \cite{relational-model}
as the representation of data for sensor networks. In general, the following
properties apply to sensor networks:

\begin{itemize}
  \item data is structured in tables, and sensor properties are represented 
 by the columns of these tables. Data instances are represented by tuples or
 rows of these tables. Finally, table relationships are implemented based
 on the relational algebra abstraction, which is the mechanism used to 
describe the relationship among different data types.
  \item data is queried using the Structured Query Languange (SQL), and uses
  the definitions of the tables and columns to extract data.
\end{itemize}

Before the conception of such model, a database normalization process is
necessary to describe the data in an appropriate way. An example of such use
of the relational model is the TinyDB database systems \cite{sn-db-tinydb},
which uses the relational model to represent the types of sensors. Due to the
popularity of relational models, this is a popular choice since of the vast
availability of research on relational database models.

Although the implementation of a relational database seems to cover the needs
of data representation, \cite{sn-data-model-survey} described the problems
related to this approach. One such problem is that the relational model is not
suited for modeling time series data and metadata related to identify, time and
location. For the problems related to it, came the implementation of different
approaches that adds semantics to data types and different query clauses to the
Structured Query Language (SQL) to solve join \cite{sn-db-newop}.

\subsection{Structured Data Model and Query}

The use of XML is used to represent data in sensor networks has become popular
due the popularity of this data format. In general, the use of XML for
persistence can be summarized as follows:

\begin{itemize}
  \item data is structured in the collected data properties can be represented through the
XML \cite{xml} instances by using tags, having its model validated by the use
of XML Schema \cite{xml-schema}.
  \item in order to extract data from XML-based databases, the use of XML XPath
  is used to query XML documents.
\end{itemize}

Some examples of the application of XML in sensor networks in 
\cite{sn-xml-usage02} some have investigated the effecient use of XML in
sensor networks to represent the collected data \cite{sn-xml-usage01}. An
example of querying xml data in sensor networks described by
\cite{sn-xml-query-engines}, while others use XML as a means of data exchange
by implementing of middlewares to query and extract query data
\cite{sn-xml-middleware}. NetBEAMS is one of such sensor network that contains
an XML-based communication middleware for data exchange among the sensor nodes
\cite{netbeams2009}.

\subsection{Key-Value Pair and Document-Oriented Data Models}

The advance of distributed systems and the Internet have enabled the
development of powerful database systems that can be organized in the context
of database systems and how to represent models. An important up-coming
approach is the use of database systems that does not use structured language
for quering its data. One such example is called Key-Value Pair (KVP) data model
\cite{db-kvp}. Such model has the following properties:

\begin{itemize}
  \item data is structured in collections of key-value pairs, as it is done in
  hash data structure. The definition of the key is a given property with its
  associating value.
  \item the query process is using mechanics similar to programming or
  scripting language, that is, the use of APIs in a given programming language.
\end{itemize}

Different variants of such data model is the document-oriented data model,
where data is modelled using structured documents. However, these documents
have a dynamic structure that can be freely described without the use of an
schema validation mechanism as used in XML Schema. One example of such
approach is the use of the JSON data format \cite{json} in the implementation
of database systems which are becoming popular with the new trend called Cloud
Computing \cite{cloud-comp-architectures}. Databases implementing this strategy
is the mongoDB \cite{mongodb} and CouchDB \cite{mongodb}.

\subsection{Data Provenance for Sensor Networks}

Most of sensor networks implementations use the collected data from the sensor
devices after they observe the environment. As shown by
\cite{sn-data-model-survey}, different data models contains its pros and
cons to represent data. However, one important aspect in sensor networks is the
description of it collected data, as \cite{sn-provenance} discussed the
properties and nature of sensor networks generated data. First, the device's
sampling are usually in raw format or without obvious names. In order to
provide search over the collected sensor data, the data needs first to be
described and indexed, and this process can be related to Data Provenance
\cite{db-provenance}.

An example of Data Provenance application is the use of aggregation of data
over time to estimate the changing effects of the weather in a given region.
For this reason, the collected data needs descriptions or annotations that can
give enough information to track changes, that is, the history of how and when
a given data has changed. The following should be the foundation of a
provenance-aware collected data according to \cite{sn-provenance}:

\begin{itemize}
  \item each low-level observation as it describes the actual data;
  \item the location where the collected data was generated;
  \item the time when the data was collected.
\end{itemize}

While Data Provenance provides necessary mechanisms to describe sensor networks
data in general, others see the importance of the time space of sensor
networks. \cite{sn-time-series} describes strategies to used to cluster
distributed sensor data as time series of data.