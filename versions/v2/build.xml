<!-- Imported by every ant build file. -->
<project name="DSP Core" basedir=".">
	
    <property environment="env"/>
	<dirname property="imported.basedir" file="${ant.file.imported}"/> 
	<property name="running.file" value="${ant.file}"/> 
	
	<property name="CORE.DIR" value="/home/marcello/development/workspaces/sfsu/netBEAMS2 OSGi General/versions/v2/" />
    <dirname property="DSP.BUNDLES" file="${CORE.DIR}/apps/osgi-bundles/dsp"/>
    <property name="FRAMEWORK" location="${DSP.BUNDLES}/DSPFramework"/>
    <property name="PLATFORM" location="${DSP.BUNDLES}/DSPPlatform"/>
    <property name="THIRDPARTY" location="${CORE.DIR}/thirdparty"/>
    <property name="DSP.RUNTIME" location="${CORE.DIR}/runtime"/>
	<property name="DSP.DEPLOYMENT" location="${DSP.RUNTIME}/deployment"/>
	<property name="DSP.VERSION" value="0.1"/>

	<path id="project.class.path">
	       <pathelement location="./lib/"/>
	        <fileset dir="${DSP.RUNTIME}/libs">
	           <include name="**/*.jar"/>
	        </fileset>
	        <fileset dir="${THIRDPARTY}">
	          <include name="**/*.jar"/>
	       </fileset>
	</path>
	
    <!-- Defines which versions of thirdparty jars to use 
    <property file="${CORE}/tools/ant/thirdparty.properties"/>

    <taskdef resource="net/sf/antcontrib/antcontrib.properties">
        <classpath>
            <pathelement location="${THIRDPARTY}/ant-contrib/${ant-contrib.version}/ant-contrib-${ant-contrib.version}.jar"/>
        </classpath>
    </taskdef>
-->
    <echo message="CORE.DIR=${CORE.DIR}"/>
    <echo message="DSP.BUNDLES=${DSP.BUNDLES}"/>
	<echo message="FRAMEWORK=${FRAMEWORK}"/>
	<echo message="PLATFORM=${PLATFORM}"/>
	<echo message="THIRDPARTY=${THIRDPARTY}"/>
	<echo message="DSP.RUNTIME=${DSP.RUNTIME}"/>
	<echo message="DSP.VERSION=${DSP.VERSION}"/>
	<echo message="imported.basedir=${imported.basedir}"/>
	<echo message="running.file=${running.file}"/>
	
	<!-- Setting up runtime directory -->
	<mkdir dir="${DSP.RUNTIME}"/>
	
	<mkdir dir="${DSP.RUNTIME}/demos/stocks/" />
	<echo file="${DSP.RUNTIME}/demos/stocks/config.xml"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<components>
    <component>
	   <name>DSPStockData</name>
	   <bundle>DSPStockData-0.1.jar</bundle>
	   <priority>20</priority>
	   <required/>
	</component>    
	<component>
	   <name>DSPStockProducer</name>
	   <bundle>DSPStockProducer-0.1.jar</bundle>
	   <priority>70</priority>
	   <required/>
	</component>
	<component>
	   <name>DSPStockConsumer</name>
	   <bundle>DSPStockConsumer-0.1.jar</bundle>
	   <priority>71</priority>
	   <required/>
    </component>
</components>
]]></echo>
	
	<mkdir dir="${DSP.DEPLOYMENT}/"/>
	<copy file="${DSP.RUNTIME}/demos/stocks/config.xml" todir="${DSP.DEPLOYMENT}/" />
    <echo file="${DSP.RUNTIME}/matcher_config.xml"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<config>
    <matchRule>
        <matchCriteria>
            <nodeAddress>LOCAL</nodeAddress>
            <componentType>org.netbeams.dsp.demo.stocks.producer</componentType>
            <!-- <messageType>org.dsp.message.CreateMessage</messageType> -->
        </matchCriteria>
        <matchTarget>

            <nodeAddress>LOCAL</nodeAddress>
            <componentType>org.netbeams.dsp.demo.stocks.consumer</componentType>
        </matchTarget>
    </matchRule>
    <matchRule>
        <matchCriteria>
            <nodeAddress>LOCAL</nodeAddress>

            <componentType>ALL</componentType>
            <!-- <messageType>org.dsp.message.CreateMessage</messageType> -->
        </matchCriteria>
        <matchTarget>
            <nodeAddress>LOCAL</nodeAddress>
            <componentType>org.netbeams.dsp.platform.channel</componentType>
        </matchTarget>
    </matchRule>
</config>]]>
        </echo>
	
	<target name="clear-runtime">
		   <delete dir="${DSP.RUNTIME}/" />
	</target>
</project>